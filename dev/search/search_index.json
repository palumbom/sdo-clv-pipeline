{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SDO Center-to-Limb Variability (CLV) Pipeline","text":"<p>This package processes SDO data to recover trends in the center-to-limbv ariability of the solar radial velocity. v0.x.y is described in Palumbo et al. (2024b). The results of this paper can be reproduced using the showyourwork workflow from this repo.</p>"},{"location":"#installation","title":"Installation","text":"<p>The <code>sdo-clv-pipeline</code> package can be trivially installed using the <code>uv</code> tool:</p> <pre><code>git clone https://github.com/palumbom/sdo-clv-pipeline.git\ncd sdo-clv-pipeline\nuv sync\n</code></pre> <p>Then in Python, simply:</p> <pre><code>import sdo_clv_pipeline\n</code></pre>"},{"location":"#citation","title":"Citation","text":"<p>If you use this code in your research, please cite the relevant software release and paper.</p>"},{"location":"#author-contact","title":"Author &amp; Contact","text":"<p>This repo is maintained by Michael Palumbo. You may may contact him via his email - mpalumbo@flatironinstitute.org</p>"},{"location":"license/","title":"License","text":"<p>MIT License</p> <p>Copyright (c) 2021 Michael L. Palumbo (palumbo.astro@gmail.com) and contributors</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"public-api/","title":"Public API","text":""},{"location":"public-api/#sdo_clv_pipelinesdo_image","title":"sdo_clv_pipeline.sdo_image","text":"<p>SDO image handling and region masking utilities.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage","title":"<code>SDOImage</code>","text":"<p>               Bases: <code>object</code></p> <p>Load an SDO image and provide geometry, corrections, and metadata.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage--parameters","title":"Parameters","text":"<p>file : str     Path to the FITS file to load. dtype : numpy dtype, optional     Data type for the image array.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.calc_limb_darkening","title":"<code>calc_limb_darkening(mu_lim=0.1, num_mu=25, n_sigma=2.0)</code>","text":"<p>Estimate limb darkening and flatten continuum/filtergram intensity.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.calc_limb_darkening--parameters","title":"Parameters","text":"<p>mu_lim : float, optional     Minimum mu used in the fit. num_mu : int, optional     Number of mu bins between mu_lim and 1. n_sigma : float, optional     Sigma clipping threshold within each bin.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.correct_dopplergram","title":"<code>correct_dopplergram(fit_cbs=False)</code>","text":"<p>Compute velocity corrections and derived components for dopplergrams.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.correct_dopplergram--parameters","title":"Parameters","text":"<p>fit_cbs : bool, optional     If True, fit convective blueshift components in the bulk velocity model.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.correct_magnetogram","title":"<code>correct_magnetogram()</code>","text":"<p>Apply mu correction to magnetogram values.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.rescale_to_hmi","title":"<code>rescale_to_hmi(hmi_image)</code>","text":"<p>Resample a filtergram onto an HMI image grid and inherit geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SDOImage.rescale_to_hmi--parameters","title":"Parameters","text":"<p>hmi_image : SDOImage     Target HMI image providing the output WCS and geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask","title":"<code>SunMask</code>","text":"<p>               Bases: <code>object</code></p> <p>Classify solar regions using continuum, magnetogram, doppler, and AIA data.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask--parameters","title":"Parameters","text":"<p>con, mag, dop, aia : SDOImage     Continuum, magnetogram, dopplergram, and filtergram images. These are     used to derive masks for umbrae, penumbrae, quiet sun, network, plage,     and moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_blue_penumbra","title":"<code>is_blue_penumbra()</code>","text":"<p>Return mask for blue-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_left_moat","title":"<code>is_left_moat()</code>","text":"<p>Return mask for left-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_moat_flow","title":"<code>is_moat_flow()</code>","text":"<p>Return mask for moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_network","title":"<code>is_network()</code>","text":"<p>Return mask for network regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_penumbra","title":"<code>is_penumbra()</code>","text":"<p>Return mask for penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_plage","title":"<code>is_plage()</code>","text":"<p>Return mask for plage regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_quiet_sun","title":"<code>is_quiet_sun()</code>","text":"<p>Return mask for quiet sun regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_red_penumbra","title":"<code>is_red_penumbra()</code>","text":"<p>Return mask for red-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_right_moat","title":"<code>is_right_moat()</code>","text":"<p>Return mask for right-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_umbra","title":"<code>is_umbra()</code>","text":"<p>Return mask for umbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.SunMask.is_unclassified","title":"<code>is_unclassified()</code>","text":"<p>Return mask for pixels with no valid region classification.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.bilinear_reproject","title":"<code>bilinear_reproject(src, src_x, src_y, dst)</code>","text":"<p>Bilinearly sample src into dst using precomputed pixel mappings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.calculate_pixel_area","title":"<code>calculate_pixel_area(lat, lon)</code>","text":"<p>Compute per-pixel areas from heliographic latitude/longitude grids.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.calculate_weights","title":"<code>calculate_weights(mag)</code>","text":"<p>Return active and quiet masks based on magnetogram thresholds.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.compute_pixel_mapping","title":"<code>compute_pixel_mapping(src_wcs, dst_wcs, shape)</code>","text":"<p>Compute source pixel coordinates for each destination pixel.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.compute_pixel_mapping--parameters","title":"Parameters","text":"<p>src_wcs : astropy.wcs.WCS     Source image WCS. dst_wcs : astropy.wcs.WCS     Destination image WCS. shape : tuple     Destination image shape as (H, W).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.gen_leg_vec","title":"<code>gen_leg_vec(lmax, theta)</code>","text":"<p>Generate normalized Legendre basis and derivative vs latitude.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.gen_leg_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. theta : astropy.units.Quantity     Colatitude in degrees.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.gen_leg_x_vec","title":"<code>gen_leg_x_vec(lmax, x)</code>","text":"<p>Generate normalized Legendre basis and derivative vs x.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.gen_leg_x_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. x : astropy.units.Quantity     Coordinate in degrees (converted to radians internally).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.get_areas","title":"<code>get_areas(labels, intensity_image)</code>","text":"<p>Compute region areas and intensity-weighted areas from label map.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.pad_max_len","title":"<code>pad_max_len(data, max_length)</code>","text":"<p>Pad a 1D array with NaNs up to max_length.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_image.round_time","title":"<code>round_time(date=None, round_to=3600)</code>","text":"<p>Round a datetime object to any time lapse in seconds dt : datetime.datetime object, default now. round_to : Closest number of seconds to round to, default 1 hour. Author: Thierry Husson 2012 - Use it as you want but don't blame me.</p>"},{"location":"public-api/#sdo_clv_pipelinesdo_process","title":"sdo_clv_pipeline.sdo_process","text":"<p>SDO processing pipeline entry points for per-epoch reductions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage","title":"<code>SDOImage</code>","text":"<p>               Bases: <code>object</code></p> <p>Load an SDO image and provide geometry, corrections, and metadata.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage--parameters","title":"Parameters","text":"<p>file : str     Path to the FITS file to load. dtype : numpy dtype, optional     Data type for the image array.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.calc_limb_darkening","title":"<code>calc_limb_darkening(mu_lim=0.1, num_mu=25, n_sigma=2.0)</code>","text":"<p>Estimate limb darkening and flatten continuum/filtergram intensity.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.calc_limb_darkening--parameters","title":"Parameters","text":"<p>mu_lim : float, optional     Minimum mu used in the fit. num_mu : int, optional     Number of mu bins between mu_lim and 1. n_sigma : float, optional     Sigma clipping threshold within each bin.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.correct_dopplergram","title":"<code>correct_dopplergram(fit_cbs=False)</code>","text":"<p>Compute velocity corrections and derived components for dopplergrams.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.correct_dopplergram--parameters","title":"Parameters","text":"<p>fit_cbs : bool, optional     If True, fit convective blueshift components in the bulk velocity model.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.correct_magnetogram","title":"<code>correct_magnetogram()</code>","text":"<p>Apply mu correction to magnetogram values.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.rescale_to_hmi","title":"<code>rescale_to_hmi(hmi_image)</code>","text":"<p>Resample a filtergram onto an HMI image grid and inherit geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SDOImage.rescale_to_hmi--parameters","title":"Parameters","text":"<p>hmi_image : SDOImage     Target HMI image providing the output WCS and geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask","title":"<code>SunMask</code>","text":"<p>               Bases: <code>object</code></p> <p>Classify solar regions using continuum, magnetogram, doppler, and AIA data.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask--parameters","title":"Parameters","text":"<p>con, mag, dop, aia : SDOImage     Continuum, magnetogram, dopplergram, and filtergram images. These are     used to derive masks for umbrae, penumbrae, quiet sun, network, plage,     and moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_blue_penumbra","title":"<code>is_blue_penumbra()</code>","text":"<p>Return mask for blue-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_left_moat","title":"<code>is_left_moat()</code>","text":"<p>Return mask for left-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_moat_flow","title":"<code>is_moat_flow()</code>","text":"<p>Return mask for moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_network","title":"<code>is_network()</code>","text":"<p>Return mask for network regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_penumbra","title":"<code>is_penumbra()</code>","text":"<p>Return mask for penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_plage","title":"<code>is_plage()</code>","text":"<p>Return mask for plage regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_quiet_sun","title":"<code>is_quiet_sun()</code>","text":"<p>Return mask for quiet sun regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_red_penumbra","title":"<code>is_red_penumbra()</code>","text":"<p>Return mask for red-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_right_moat","title":"<code>is_right_moat()</code>","text":"<p>Return mask for right-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_umbra","title":"<code>is_umbra()</code>","text":"<p>Return mask for umbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.SunMask.is_unclassified","title":"<code>is_unclassified()</code>","text":"<p>Return mask for pixels with no valid region classification.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.bilinear_reproject","title":"<code>bilinear_reproject(src, src_x, src_y, dst)</code>","text":"<p>Bilinearly sample src into dst using precomputed pixel mappings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.calculate_pixel_area","title":"<code>calculate_pixel_area(lat, lon)</code>","text":"<p>Compute per-pixel areas from heliographic latitude/longitude grids.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.calculate_weights","title":"<code>calculate_weights(mag)</code>","text":"<p>Return active and quiet masks based on magnetogram thresholds.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_disk_results","title":"<code>compute_disk_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_w_quiet, flat_w_active, flat_abs_mag, mu_thresh, k_hat_con)</code>","text":"<p>Compute disk-integrated velocity and intensity metrics.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_disk_results--parameters","title":"Parameters","text":"<p>mjd : float     Observation time in modified Julian date. flat_mu, flat_int, flat_v_corr, flat_v_rot : array-like     Flattened arrays of mu, intensity, corrected velocity, and rotation velocity. flat_ld, flat_iflat : array-like     Flattened limb-darkening model and flattened intensity. flat_w_quiet, flat_w_active : array-like     Boolean weights for quiet and active regions. flat_abs_mag : array-like     Absolute magnetogram values. mu_thresh : float     Minimum mu to include in the aggregation. k_hat_con : float     Continuum scaling factor for the photometric term.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_pixel_mapping","title":"<code>compute_pixel_mapping(src_wcs, dst_wcs, shape)</code>","text":"<p>Compute source pixel coordinates for each destination pixel.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_pixel_mapping--parameters","title":"Parameters","text":"<p>src_wcs : astropy.wcs.WCS     Source image WCS. dst_wcs : astropy.wcs.WCS     Destination image WCS. shape : tuple     Destination image shape as (H, W).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_region_only_results","title":"<code>compute_region_only_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_abs_mag, flat_w_quiet, flat_w_active, flat_reg, region_codes, mu_thresh, k_hat_con)</code>","text":"<p>Compute region-aggregated metrics across the full disk.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.compute_region_results","title":"<code>compute_region_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_abs_mag, flat_w_quiet, flat_w_active, flat_reg, region_codes, mu_thresh, n_rings, k_hat_con)</code>","text":"<p>Compute region-aggregated metrics in mu rings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.gen_leg_vec","title":"<code>gen_leg_vec(lmax, theta)</code>","text":"<p>Generate normalized Legendre basis and derivative vs latitude.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.gen_leg_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. theta : astropy.units.Quantity     Colatitude in degrees.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.gen_leg_x_vec","title":"<code>gen_leg_x_vec(lmax, x)</code>","text":"<p>Generate normalized Legendre basis and derivative vs x.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.gen_leg_x_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. x : astropy.units.Quantity     Coordinate in degrees (converted to radians internally).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.get_areas","title":"<code>get_areas(labels, intensity_image)</code>","text":"<p>Compute region areas and intensity-weighted areas from label map.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.is_quality_data","title":"<code>is_quality_data(sdo_image)</code>","text":"<p>Return True when the SDO image passes the QUALITY flag check.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.pad_max_len","title":"<code>pad_max_len(data, max_length)</code>","text":"<p>Pad a 1D array with NaNs up to max_length.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.process_data_set","title":"<code>process_data_set(con_file, mag_file, dop_file, aia_file, mu_thresh, n_rings=10, suffix=None, datadir=None, **kwargs)</code>","text":"<p>Run the full processing pipeline and persist per-epoch outputs.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.process_data_set_parallel","title":"<code>process_data_set_parallel(con_file, mag_file, dop_file, aia_file, mu_thresh, n_rings, datadir)</code>","text":"<p>Wrapper for multiprocessing that forwards to process_data_set.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.reduce_sdo_images","title":"<code>reduce_sdo_images(con_file, mag_file, dop_file, aia_file, mu_thresh=0.1, fit_cbs=False, **kwargs)</code>","text":"<p>Load, validate, and reduce a set of SDO images for a single epoch.</p> <p>This handles geometry setup, limb darkening, doppler/magnetogram corrections, and region classification.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_process.round_time","title":"<code>round_time(date=None, round_to=3600)</code>","text":"<p>Round a datetime object to any time lapse in seconds dt : datetime.datetime object, default now. round_to : Closest number of seconds to round to, default 1 hour. Author: Thierry Husson 2012 - Use it as you want but don't blame me.</p>"},{"location":"public-api/#sdo_clv_pipelinesdo_vels","title":"sdo_clv_pipeline.sdo_vels","text":"<p>Velocity aggregation helpers for disk- and region-level summaries.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage","title":"<code>SDOImage</code>","text":"<p>               Bases: <code>object</code></p> <p>Load an SDO image and provide geometry, corrections, and metadata.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage--parameters","title":"Parameters","text":"<p>file : str     Path to the FITS file to load. dtype : numpy dtype, optional     Data type for the image array.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.calc_limb_darkening","title":"<code>calc_limb_darkening(mu_lim=0.1, num_mu=25, n_sigma=2.0)</code>","text":"<p>Estimate limb darkening and flatten continuum/filtergram intensity.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.calc_limb_darkening--parameters","title":"Parameters","text":"<p>mu_lim : float, optional     Minimum mu used in the fit. num_mu : int, optional     Number of mu bins between mu_lim and 1. n_sigma : float, optional     Sigma clipping threshold within each bin.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.correct_dopplergram","title":"<code>correct_dopplergram(fit_cbs=False)</code>","text":"<p>Compute velocity corrections and derived components for dopplergrams.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.correct_dopplergram--parameters","title":"Parameters","text":"<p>fit_cbs : bool, optional     If True, fit convective blueshift components in the bulk velocity model.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.correct_magnetogram","title":"<code>correct_magnetogram()</code>","text":"<p>Apply mu correction to magnetogram values.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.rescale_to_hmi","title":"<code>rescale_to_hmi(hmi_image)</code>","text":"<p>Resample a filtergram onto an HMI image grid and inherit geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SDOImage.rescale_to_hmi--parameters","title":"Parameters","text":"<p>hmi_image : SDOImage     Target HMI image providing the output WCS and geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask","title":"<code>SunMask</code>","text":"<p>               Bases: <code>object</code></p> <p>Classify solar regions using continuum, magnetogram, doppler, and AIA data.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask--parameters","title":"Parameters","text":"<p>con, mag, dop, aia : SDOImage     Continuum, magnetogram, dopplergram, and filtergram images. These are     used to derive masks for umbrae, penumbrae, quiet sun, network, plage,     and moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_blue_penumbra","title":"<code>is_blue_penumbra()</code>","text":"<p>Return mask for blue-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_left_moat","title":"<code>is_left_moat()</code>","text":"<p>Return mask for left-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_moat_flow","title":"<code>is_moat_flow()</code>","text":"<p>Return mask for moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_network","title":"<code>is_network()</code>","text":"<p>Return mask for network regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_penumbra","title":"<code>is_penumbra()</code>","text":"<p>Return mask for penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_plage","title":"<code>is_plage()</code>","text":"<p>Return mask for plage regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_quiet_sun","title":"<code>is_quiet_sun()</code>","text":"<p>Return mask for quiet sun regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_red_penumbra","title":"<code>is_red_penumbra()</code>","text":"<p>Return mask for red-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_right_moat","title":"<code>is_right_moat()</code>","text":"<p>Return mask for right-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_umbra","title":"<code>is_umbra()</code>","text":"<p>Return mask for umbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.SunMask.is_unclassified","title":"<code>is_unclassified()</code>","text":"<p>Return mask for pixels with no valid region classification.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.bilinear_reproject","title":"<code>bilinear_reproject(src, src_x, src_y, dst)</code>","text":"<p>Bilinearly sample src into dst using precomputed pixel mappings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.calculate_pixel_area","title":"<code>calculate_pixel_area(lat, lon)</code>","text":"<p>Compute per-pixel areas from heliographic latitude/longitude grids.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.calculate_weights","title":"<code>calculate_weights(mag)</code>","text":"<p>Return active and quiet masks based on magnetogram thresholds.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_disk_results","title":"<code>compute_disk_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_w_quiet, flat_w_active, flat_abs_mag, mu_thresh, k_hat_con)</code>","text":"<p>Compute disk-integrated velocity and intensity metrics.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_disk_results--parameters","title":"Parameters","text":"<p>mjd : float     Observation time in modified Julian date. flat_mu, flat_int, flat_v_corr, flat_v_rot : array-like     Flattened arrays of mu, intensity, corrected velocity, and rotation velocity. flat_ld, flat_iflat : array-like     Flattened limb-darkening model and flattened intensity. flat_w_quiet, flat_w_active : array-like     Boolean weights for quiet and active regions. flat_abs_mag : array-like     Absolute magnetogram values. mu_thresh : float     Minimum mu to include in the aggregation. k_hat_con : float     Continuum scaling factor for the photometric term.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_pixel_mapping","title":"<code>compute_pixel_mapping(src_wcs, dst_wcs, shape)</code>","text":"<p>Compute source pixel coordinates for each destination pixel.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_pixel_mapping--parameters","title":"Parameters","text":"<p>src_wcs : astropy.wcs.WCS     Source image WCS. dst_wcs : astropy.wcs.WCS     Destination image WCS. shape : tuple     Destination image shape as (H, W).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_region_only_results","title":"<code>compute_region_only_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_abs_mag, flat_w_quiet, flat_w_active, flat_reg, region_codes, mu_thresh, k_hat_con)</code>","text":"<p>Compute region-aggregated metrics across the full disk.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.compute_region_results","title":"<code>compute_region_results(mjd, flat_mu, flat_int, flat_v_corr, flat_v_rot, flat_ld, flat_iflat, flat_abs_mag, flat_w_quiet, flat_w_active, flat_reg, region_codes, mu_thresh, n_rings, k_hat_con)</code>","text":"<p>Compute region-aggregated metrics in mu rings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.gen_leg_vec","title":"<code>gen_leg_vec(lmax, theta)</code>","text":"<p>Generate normalized Legendre basis and derivative vs latitude.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.gen_leg_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. theta : astropy.units.Quantity     Colatitude in degrees.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.gen_leg_x_vec","title":"<code>gen_leg_x_vec(lmax, x)</code>","text":"<p>Generate normalized Legendre basis and derivative vs x.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.gen_leg_x_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. x : astropy.units.Quantity     Coordinate in degrees (converted to radians internally).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.get_areas","title":"<code>get_areas(labels, intensity_image)</code>","text":"<p>Compute region areas and intensity-weighted areas from label map.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.pad_max_len","title":"<code>pad_max_len(data, max_length)</code>","text":"<p>Pad a 1D array with NaNs up to max_length.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_vels.round_time","title":"<code>round_time(date=None, round_to=3600)</code>","text":"<p>Round a datetime object to any time lapse in seconds dt : datetime.datetime object, default now. round_to : Closest number of seconds to round to, default 1 hour. Author: Thierry Husson 2012 - Use it as you want but don't blame me.</p>"},{"location":"public-api/#sdo_clv_pipelinesdo_plot","title":"sdo_clv_pipeline.sdo_plot","text":"<p>Plotting helpers for SDO images and region masks.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage","title":"<code>SDOImage</code>","text":"<p>               Bases: <code>object</code></p> <p>Load an SDO image and provide geometry, corrections, and metadata.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage--parameters","title":"Parameters","text":"<p>file : str     Path to the FITS file to load. dtype : numpy dtype, optional     Data type for the image array.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.calc_limb_darkening","title":"<code>calc_limb_darkening(mu_lim=0.1, num_mu=25, n_sigma=2.0)</code>","text":"<p>Estimate limb darkening and flatten continuum/filtergram intensity.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.calc_limb_darkening--parameters","title":"Parameters","text":"<p>mu_lim : float, optional     Minimum mu used in the fit. num_mu : int, optional     Number of mu bins between mu_lim and 1. n_sigma : float, optional     Sigma clipping threshold within each bin.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.correct_dopplergram","title":"<code>correct_dopplergram(fit_cbs=False)</code>","text":"<p>Compute velocity corrections and derived components for dopplergrams.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.correct_dopplergram--parameters","title":"Parameters","text":"<p>fit_cbs : bool, optional     If True, fit convective blueshift components in the bulk velocity model.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.correct_magnetogram","title":"<code>correct_magnetogram()</code>","text":"<p>Apply mu correction to magnetogram values.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.rescale_to_hmi","title":"<code>rescale_to_hmi(hmi_image)</code>","text":"<p>Resample a filtergram onto an HMI image grid and inherit geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SDOImage.rescale_to_hmi--parameters","title":"Parameters","text":"<p>hmi_image : SDOImage     Target HMI image providing the output WCS and geometry.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask","title":"<code>SunMask</code>","text":"<p>               Bases: <code>object</code></p> <p>Classify solar regions using continuum, magnetogram, doppler, and AIA data.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask--parameters","title":"Parameters","text":"<p>con, mag, dop, aia : SDOImage     Continuum, magnetogram, dopplergram, and filtergram images. These are     used to derive masks for umbrae, penumbrae, quiet sun, network, plage,     and moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_blue_penumbra","title":"<code>is_blue_penumbra()</code>","text":"<p>Return mask for blue-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_left_moat","title":"<code>is_left_moat()</code>","text":"<p>Return mask for left-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_moat_flow","title":"<code>is_moat_flow()</code>","text":"<p>Return mask for moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_network","title":"<code>is_network()</code>","text":"<p>Return mask for network regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_penumbra","title":"<code>is_penumbra()</code>","text":"<p>Return mask for penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_plage","title":"<code>is_plage()</code>","text":"<p>Return mask for plage regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_quiet_sun","title":"<code>is_quiet_sun()</code>","text":"<p>Return mask for quiet sun regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_red_penumbra","title":"<code>is_red_penumbra()</code>","text":"<p>Return mask for red-shifted penumbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_right_moat","title":"<code>is_right_moat()</code>","text":"<p>Return mask for right-hand moat flow regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_umbra","title":"<code>is_umbra()</code>","text":"<p>Return mask for umbra regions.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.SunMask.is_unclassified","title":"<code>is_unclassified()</code>","text":"<p>Return mask for pixels with no valid region classification.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.bilinear_reproject","title":"<code>bilinear_reproject(src, src_x, src_y, dst)</code>","text":"<p>Bilinearly sample src into dst using precomputed pixel mappings.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.calculate_pixel_area","title":"<code>calculate_pixel_area(lat, lon)</code>","text":"<p>Compute per-pixel areas from heliographic latitude/longitude grids.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.calculate_weights","title":"<code>calculate_weights(mag)</code>","text":"<p>Return active and quiet masks based on magnetogram thresholds.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.compute_pixel_mapping","title":"<code>compute_pixel_mapping(src_wcs, dst_wcs, shape)</code>","text":"<p>Compute source pixel coordinates for each destination pixel.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.compute_pixel_mapping--parameters","title":"Parameters","text":"<p>src_wcs : astropy.wcs.WCS     Source image WCS. dst_wcs : astropy.wcs.WCS     Destination image WCS. shape : tuple     Destination image shape as (H, W).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.gen_leg_vec","title":"<code>gen_leg_vec(lmax, theta)</code>","text":"<p>Generate normalized Legendre basis and derivative vs latitude.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.gen_leg_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. theta : astropy.units.Quantity     Colatitude in degrees.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.gen_leg_x_vec","title":"<code>gen_leg_x_vec(lmax, x)</code>","text":"<p>Generate normalized Legendre basis and derivative vs x.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.gen_leg_x_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. x : astropy.units.Quantity     Coordinate in degrees (converted to radians internally).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.get_areas","title":"<code>get_areas(labels, intensity_image)</code>","text":"<p>Compute region areas and intensity-weighted areas from label map.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.label_moats_on_sun","title":"<code>label_moats_on_sun(mask, outdir=None, fname=None)</code>","text":"<p>Overlay moat region labels using precomputed moat data.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.pad_max_len","title":"<code>pad_max_len(data, max_length)</code>","text":"<p>Pad a 1D array with NaNs up to max_length.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.plot_image","title":"<code>plot_image(sdo_image, outdir=None, fname=None)</code>","text":"<p>Plot an SDOImage with WCS axes and type-specific styling.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.plot_image--parameters","title":"Parameters","text":"<p>sdo_image : SDOImage     Image to plot (magnetogram, dopplergram, continuum, or filtergram). outdir : str, optional     If provided, save to this directory instead of showing. fname : str, optional     Filename for the saved figure (auto-generated if None).</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.plot_mask","title":"<code>plot_mask(mask, outdir=None, fname=None)</code>","text":"<p>Plot a SunMask classification map with labeled region colors.</p>"},{"location":"public-api/#sdo_clv_pipeline.sdo_plot.round_time","title":"<code>round_time(date=None, round_to=3600)</code>","text":"<p>Round a datetime object to any time lapse in seconds dt : datetime.datetime object, default now. round_to : Closest number of seconds to round to, default 1 hour. Author: Thierry Husson 2012 - Use it as you want but don't blame me.</p>"},{"location":"public-api/#sdo_clv_pipelinesdo_download","title":"sdo_clv_pipeline.sdo_download","text":""},{"location":"public-api/#sdo_clv_pipelinelegendre","title":"sdo_clv_pipeline.legendre","text":"<p>Legendre basis helpers used for dopplergram bulk-velocity fits.</p>"},{"location":"public-api/#sdo_clv_pipeline.legendre.gen_leg_vec","title":"<code>gen_leg_vec(lmax, theta)</code>","text":"<p>Generate normalized Legendre basis and derivative vs latitude.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.legendre.gen_leg_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. theta : astropy.units.Quantity     Colatitude in degrees.</p>"},{"location":"public-api/#sdo_clv_pipeline.legendre.gen_leg_x_vec","title":"<code>gen_leg_x_vec(lmax, x)</code>","text":"<p>Generate normalized Legendre basis and derivative vs x.</p> <p>This is used by dopplergram bulk-velocity modeling to build design matrices.</p>"},{"location":"public-api/#sdo_clv_pipeline.legendre.gen_leg_x_vec--parameters","title":"Parameters","text":"<p>lmax : int     Maximum degree of the Legendre series. x : astropy.units.Quantity     Coordinate in degrees (converted to radians internally).</p>"},{"location":"public-api/#sdo_clv_pipelinereproject","title":"sdo_clv_pipeline.reproject","text":"<p>Lightweight WCS-based reprojection helpers.</p>"},{"location":"public-api/#sdo_clv_pipeline.reproject.bilinear_reproject","title":"<code>bilinear_reproject(src, src_x, src_y, dst)</code>","text":"<p>Bilinearly sample src into dst using precomputed pixel mappings.</p>"},{"location":"public-api/#sdo_clv_pipeline.reproject.compute_pixel_mapping","title":"<code>compute_pixel_mapping(src_wcs, dst_wcs, shape)</code>","text":"<p>Compute source pixel coordinates for each destination pixel.</p>"},{"location":"public-api/#sdo_clv_pipeline.reproject.compute_pixel_mapping--parameters","title":"Parameters","text":"<p>src_wcs : astropy.wcs.WCS     Source image WCS. dst_wcs : astropy.wcs.WCS     Destination image WCS. shape : tuple     Destination image shape as (H, W).</p>"}]}